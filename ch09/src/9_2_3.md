# ストリームで表現された二進数のinc

incの特性からONEをincするときは、繰り上がりによって再帰的なincの呼び出しが発生して、その結果log n程度に悪化するというのがもともとの問題。
この繰り上がりのコストを、よりコストの低いZEROのincに負担させたい。

ONEは0、ZEROは1までの負債を負わせてよいという話。
ZEROのincはコストが定数であり、またZEROは繰り上がりを引き起こす前に必ずincによってONEになる。なのでZEROのincについて債務を1つ返却させるという余計なコストを負わせる。

繰り上がりを起こす直前というのは、例えば [ONE, ONE, ... ONE, ZERO, ... ONE] のようになっている。このとき左から見て最初のZEROよりも左側にあるONEの個数をk個とする(k=1でもよい)。
繰り上がった結果は [ZERO, ZERO, ... ZERO, ONE, ... ONE] となる。もしも即時評価されるなら、このときk+1回のincが走るため、k+1のコストが発生する。そこでこのk+1を先頭k+1個の要素に均等に負債として計上する。前提から先頭からk個のZEROは1の債務を負わせていい。k+1番目のONEは、直線の状態でk+1番目のZEROが債務を負っていたかに依存して1もしくは2の債務を負うことになるが、前提よりONEは債務を負えない。そこで、実行したincにその支払いを負担させることになる。ここでincが追加で負担することになるのは、たかだか2までなので、全体として償却コストはO(1)程度におさまる。

# ストリームで表現された二進数のdec

今度はincと対照的に、ZEROをdecするときに繰り下がりによって再帰的なdecの呼び出しが発生する。
一方でONEのdecはコストが低い。

となると、incとは逆でONEは1、ZEROは0までの負債を負わせるということになる。

# これで困るケース

繰り上がりと繰り下がりを連続で行うケース。
例えば、(A)のケースで繰り上がりをして、債務を2支払ったケースでは最小の桁が1の債務を持っているので、decを実行できない。

[ONE, ONE, ZERO]  (債務は[0, 0, 1]) ... (A)
[ZERO, ZERO, ONE] (債務は[1, 1, 0]) ... (B)

